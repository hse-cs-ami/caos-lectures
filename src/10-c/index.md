# –Ø–∑—ã–∫ –°–∏
## –ò—Å—Ç–æ—Ä–∏—è
![](kt-dr-pdp11.jpg)
–ö–µ–Ω –¢–æ–º–ø—Å–æ–Ω –∏ –î–µ–Ω–Ω–∏—Å –†–∏—á–∏ —É PDP-11

[–í–∏–∫–∏–ø–µ–¥–∏—è –ø—Ä–æ –∏—Å—Ç–æ—Ä–∏—é —è–∑—ã–∫–∞ –°–∏](https://en.wikipedia.org/wiki/C_(programming_language)#History)

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç –°17 (–ø—Ä–æ—à–ª—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã: C89, C99, C11; –≥—Ä—è–¥—ë—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç C23).

[–ß–µ—Ä–Ω–æ–≤–∏–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞](https://www.open-std.org/JTC1/SC22/WG14/www/docs/n1570.pdf) (—Å–∞–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç
–º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å —É ISO –∑–∞ –±–æ–ª—å—à–∏–µ –¥–µ–Ω—å–≥–∏,
—Ç–∞–º –Ω–∞–ø–∏—Å–∞–Ω–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ.)

## –ß—Ç–æ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç
* Implementation-defined behavior
  * –ü—Ä–∏–º–µ—Ä: –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª (two's complement, sign-magnitude)
* Unspecified behavior 
  * –ü—Ä–∏–º–µ—Ä: –ø–æ—Ä—è–¥–æ–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`f(g(), h())`)
* Undefined behavior (UB)
  * –ü—Ä–∏–º–µ—Ä: –≤—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞

[–°—Ç–∞—Ç—å—è –ø—Ä–æ —Ç–æ, –∑–∞—á–µ–º –Ω–∞–º –Ω—É–∂–µ–Ω UB](https://www.ralfj.de/blog/2021/11/18/ub-good-idea.html)

```c
*p = 1;
if (!p) {
    fprintf(stderr, ‚ÄúNULL pointer\n‚Äù);
    return;
}
```

## –¶–µ–ª—ã–µ —Ç–∏–ø—ã
```c
char        signed char         unsigned char
short     = signed short        unsigned short
int       = signed int          unsigned int
long      = signed char         unsigned char
long long = signed long long    unsigned long long
```

* CHAR_BIT >= 8
* sizeof(char)== 1
* sizeof(signed T) == sizeof(unsigned T) == sizeof(T)
* short –∫–∞–∫ –º–∏–Ω–∏–º—É–º 16 –±–∏—Ç
* int –∫–∞–∫ –º–∏–Ω–∏–º—É–º 16 –±–∏—Ç
* long –∫–∞–∫ –º–∏–Ω–∏–º—É–º 32 –±–∏—Ç–∞
* long long –∫–∞–∫ –º–∏–Ω–∏–º—É–º 64 –±–∏—Ç–∞

sizeof –¥–ª—è —Ç–∏–ø–æ–≤:
```c
–¢–∏–ø       Atmel AVR  32-bit  Win64  64-bit
char      1          1       1      1
short     2          2       2      2
int       2          4       4      4
long      4          4       4      8
long long -          8       8      8
__int128  -          -       -      16
```

```c
#include <limits.h>
CHAR_MIN, CHAR_MAX, SCHAR_MIN, SCHAR_MAX,
UCHAR_MIN, ..., INT_MIN, INT_MAX, UINT_MAX,
LONG_MIN, LONG_MAX, ULONG_MAX, LLONG_MIN,
LLONG_MAX, ULLONG_MAX
```

–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª `<stdint.h>`:
* –ó–Ω–∞–∫–æ–≤—ã–µ —Ç–∏–ø—ã: `int8_t, int16_t, int32_t, int64_t`
* –ë–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ —Ç–∏–ø—ã: `uint8_t, uint16_t, uint32_t, uint64_t`
* –¢–∏–ø—ã —Ä–∞–∑–º–µ—Ä–∞, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
  –∞–¥—Ä–µ—Å–∞ –≤ –ø–∞–º—è—Ç–∏: `intptr_t, uintptr_t`
* `int8_min_t` (–º–∏–Ω–∏–º—É–º 8 –±–∏—Ç, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ, –µ—Å–ª–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç —Å 8 –±–∏—Ç–∞–º–∏), `int8_fast_t`(–º–∏–Ω–∏–º—É–º 8 –±–∏—Ç, –Ω–æ –±–æ–ª—å—à–µ, –µ—Å–ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç–∞–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –±—ã—Å—Ç—Ä–µ–µ)

–î–ª—è —Ü–µ–ª–æ–≥–æ –ª–∏—Ç–µ—Ä–∞–ª–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π —Ç–∏–ø –∏–∑ —Å–ø–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –µ–≥–æ –≤–º–µ—Å—Ç–∏—Ç—å:
* –¥–ª—è –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç ‚Äî `int`, `long`, `long long`;
* –¥–ª—è –≤–æ—Å—å–º–µ—Ä–∏—á–Ω—ã—Ö –∏ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç ‚Äî `int`, `unsigned`, `long`, `unsigned long`,
  `long long`, `unsigned long long`.

–ù–∞–ø—Ä–∏–º–µ—Ä:
```c
10  // —Ç–∏–ø int
2147483648 // –Ω–∞ gcc/amd64 ‚Äì —Ç–∏–ø long, –Ω–∞ x86_32 ‚Äì —Ç–∏–ø long long
0x80000000 // —Ç–æ –∂–µ —á–∏—Å–ª–æ, –Ω–æ —Ç–∏–ø –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã unsigned int
```

–°—É—Ñ—Ñ–∏–∫—Å—ã –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
```c
0    // int
0U   // unsigned
0L   // long
0UL  // unsigned long
0LU  // unsigned long
0LL  // long long
0ULL // unsigned long long
0LLU // unsigned long long
```

## –ó–Ω–∞–∫–æ–≤–∞—è –∏ –±–µ–∑–∑–Ω–∞–∫–æ–≤–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞
Unsigned ‚Äì –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –ø–æ –º–æ–¥—É–ª—é \\(2^N\\).

Signed ‚Äì –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, UB.

```c
    UINT_MAX + 1;  // OK, always 0
    INT_MAX + 1;   // UB
    int i;
    i < i + 1;     // the compiler may assume this is always true
```

–û–ø—Ü–∏–∏ gcc:
* `-ftrapv` ‚Äì abort() –ø—Ä–∏ –∑–Ω–∞–∫–æ–≤–æ–º —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–º
–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏
* `-fwrapv` ‚Äì –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–Ω–∞–∫–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ
–º–æ–¥—É–ª—é 2^N, –Ω–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –¥–µ–ª–∞–µ—Ç
–Ω–∏–∫–∞–∫–∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π
* `-fsanitize=undefined` ‚Äì —á–∞—Å—Ç–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ undefined
behavior –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

–î–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –∑–Ω–∞–∫–æ–≤–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–µ –º–æ–∂–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è [GCC built-in overflow detection](https://gcc.gnu.org/onlinedocs/gcc/Integer-Overflow-Builtins.html)

## Implicit conversions

Integer promotion: —á–∏—Å–ª–∞ –∫–æ—Ä–æ—á–µ, —á–µ–º int (—Ç–æ –µ—Å—Ç—å char, short) –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏—Ö –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö –ø—Ä–µ–≤—Ä–∞—Ç—è—Ç—Å—è –≤ int –∏–ª–∏ unsigned int

[cppreference on implicit conversions](https://en.cppreference.com/w/c/language/conversion)

## Hello World

```c
#include <stdio.h>

#define GREETING "Hello, world!\n"
// –º–∞–∫—Ä–æ—Å –±—É–¥–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç –≤ —Ö–æ–¥–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏—Ä–æ–≤–∞–Ω–∏—è

int main(void) {
    printf("Hello, world!\n");
    return 0;
}
```

```c
int main(){} //–æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
```

```c
// –∑–∞–ø—É—Å–∫
gcc hello.c -o hello
./hello
gcc -c hello.c - –¥–µ–ª–∞–µ—Ç –æ–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª
gcc -S hello.c - –¥–µ–ª–∞–µ—Ç –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–π —Ñ–∞–π–ª
gcc -E hello.c - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —Å—Ç–∞–¥–∏–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏—Ä–æ–≤–∞–Ω–∏—è
gcc -Wall -Werror // show all warnings, warnings will be treated as errors
```

–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ main: –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ –Ω–∞—à–ª–∞—Å—å - –æ—à–∏–±–∫–∞ –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏. Main - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å, –∏ —ç—Ç–æ –Ω–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ UB. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è, —á—Ç–æ main –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0

```c
#include <stdio.h>

int foobar() {}

int main(void) {
    int x = foobar(); // UB 
    return 0;
}
```

### –ö–ª–∞—Å—Å—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```c
int x; // —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∞—Å—Å —Ö—Ä–∞–Ω–µ–Ω–∏—è
extern int ext; // –≤–Ω–µ—à–Ω–∏–π –∫–ª–∞—Å—Å —Ö—Ä–∞–Ω–µ–Ω–∏—è (–æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è)

void foo(void) {
    int y; // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π
    static int z; // —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π
    register int t; // —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤—ã–π
}
```

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π** : –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±—ä—è–≤–ª–µ–Ω–∞ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–≤–æ–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏–∏, –ø–µ—Ä–µ—Å—Ç–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–æ –µ—Å—Ç—å –∂–∏–≤–µ—Ç –Ω–∞ —Å—Ç–µ–∫–µ). –ï—Å–ª–∏ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, —Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π - –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±—É–¥–µ—Ç ub.
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π:** —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤—Å–µ –≤—Ä–µ–º—è, –ø–æ–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞ (–ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Å–µ–∫—Ü–∏—é data/bss). –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è 0 (–ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É), –µ—Å–ª–∏ –∏—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å.
- **–†–µ–≥–∏—Å—Ç—Ä–æ–≤—ã–π** - –Ω–µ—Ç –∞–¥—Ä–µ—Å–∞ –≤ –ø–∞–º—è—Ç–∏


### –ö–ª–∞—Å—Å—ã –ª–∏–Ω–∫–æ–≤–∫–∏

–í–Ω–µ—à–Ω—è—è –ª–∏–Ω–∫–æ–≤–∫–∞ ‚Äî —Å–∏–º–≤–æ–ª –≤–∏–¥–µ–Ω –∏–∑ –¥—Ä—É–≥–∏—Ö –µ–¥–∏–Ω–∏—Ü —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏
(–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `.global` –≤ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ).

–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–∏–Ω–∫–æ–≤–∫–∞ ‚Äî —Å–∏–º–≤–æ–ª –Ω–µ –≤–∏–¥–µ–Ω –∏–∑ –¥—Ä—É–≥–∏—Ö –µ–¥–∏–Ω–∏—Ü —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏.
–î–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ `static`.

```c
// –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç –≤–Ω–µ—à–Ω—é—é –ª–∏–Ω–∫–æ–≤–∫—É
int var;
int foo(int arg) {
    ...
}
// –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ static –≤–∫–ª—é—á–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ª–∏–Ω–∫–æ–≤–∫—É
static int var2;
static void bar(void) {
    ...
}
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `static` –∏–º–µ–µ—Ç –¥–≤–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–º—ã—Å–ª–∞.

–¢–∏–ø–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏:
```c
// foo.c
int x; // –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –≤–Ω–µ—à–Ω–µ–π –ª–∏–Ω–∫–æ–≤–∫–æ–π —Ä–æ–≤–Ω–æ –≤ –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏

// bar.c
extern int x; // –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å –≤–Ω–µ—à–Ω–∏–º –∫–ª–∞—Å—Å–æ–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ—á–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏
```

–¢–∏–ø–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏:
```c
// fun.c
int fun(int a, int b) { // –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –≤–Ω–µ—à–Ω–µ–π –ª–∏–Ω–∫–æ–≤–∫–æ–π —Ä–æ–≤–Ω–æ –≤ –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏
    ...
}

// main.c
int fun(int a, int b); // –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏

...
    result = fun(3, 4);
...
```

## –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

### –ú–∞–∫—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏

```c
#define SHORT_MAX 32767

int func_returning_SHORT_MAX() {
    puts("this function returns SHORT_MAX");
    return SHORT_MAX;
}
```

### –í–∫–ª—é—á–µ–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ —Ñ–∞–π–ª–∞

```c
#include "filename.c"
```

### –ó–∞–ø–∏—Å—å –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö

```c
//incr.h
int incr(void);
```

```c
#include <stdio.h> // —Å–∏—Å—Ç–µ–º–Ω—ã–π
#include "incr.h"  // –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π

#define GREETING "Hello, world\n"

int main(void) {
    printf(printf("x is %d\n", incr()));
    return 0;
}
```

### Header guard

–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –≤ –∫–æ–¥ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –Ω–æ –º–æ–∂–µ—Ç –≤—Å–µ —Å–ª–æ–º–∞—Ç—å. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Ä–æ—Å:

```c
//foo.h
#ifndef FOO_H
#define FOO_H

static int helper_func(int arg) {
    return arg + 1;
}

#endif
```

–ü–æ—á—Ç–∏ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–≤ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å  `#pragma once`

## –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ç–∏–ø—ã
### –°—Ç—Ä—É–∫—Ç—É—Ä—ã

–ë–µ–∑ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ `struct` —Ç—ç–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∏–º–µ–Ω–µ–º —Ç–∏–ø–∞.

```c
#include <stdio.h>
#include "incr.h"

struct example {
    char b;
    int i;
    long long l;
};

int main(void) {
    struct example p1 = {1, 2, 3};
    struct example p = {.b = 1, .l = 2};
    // –µ—Å–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ–æ–±—â–µ –µ—Å—Ç—å, —Ç–æ –∫–æ–≥–æ —è–≤–Ω–æ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ - —Ç–æ—Ç 0
    printf("x is %d\n", p.i);
}
```

### –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤

–í —Å–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –û–±—ã—á–Ω–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ä–∞–≤–Ω–æ —Ä–∞–∑–º–µ—Ä—É —Ç–∏–ø–∞, –Ω–æ –Ω–µ
–±–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞. –ù–∞ amd64:
```
_Alignof(char) ==	1
_Alignof(short) ==	2
_Alignof(int) ==	4
_Alignof(long) ==	8
_Alignof(long long) ==	8
```

–ß—Ç–æ–±—ã —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—ã—Ä–æ–≤–Ω—è–ª–∏—Å—å, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ–∂–¥—É –Ω–∏–º–∏
*padding* - –ø—É—Å—Ç—ã–µ –±–∞–π—Ç—ã. –£ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ —Ü–µ–ª–æ–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–∑ –≤—Å–µ—Ö
–µ–µ —á–ª–µ–Ω–æ–≤.

```c
struct example { // aligned to 8 bytes
    char b;
    // 3 padding bytes
    int i;
    // no padding bytes
    long long l;
    char c;
    // 7 padding bytes
};
```

**–ö–∞–∫ –ø–æ–ø—Ä–æ—Å–∏—Ç—å GCC –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–∞–¥–¥–∏–Ω–≥**

```c
struct example {
    char b;
    int i;
    long long l;
} __attribute__((packed));
```

### –ú–∞—Å—Å–∏–≤—ã

```c
// –ø—É—Å—Ç–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
int arr[10] = {0} // –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
// –º–æ–∂–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞
int arr[10] = {[5] = 4};

// –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ = –∫–æ–ª-–≤–æ –∏–Ω–∏—Ü–∏–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
int arr[] = {1,2,3}
```

–í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞ - ub. –£–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä—ã –º–∞—Å—Å–∏–≤–∞ –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å.

```c
#define ARRLEN(a) (sizeof(a) / sizeof((a)[0]))

int main() {
    int arr[10] = {[5] = 4};
    for (int i = 0; i < ARRLEN(arr); ++i) {
        printf("%d\n", arr[i]);
    }
}
```

## –£–∫–∞–∑–∞—Ç–µ–ª–∏

```c
&p; // –≤–∑—è—Ç—å –∞–¥—Ä–µ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
int* p = &arr[0]; // —É–∫–∞–∑–∞—Ç–µ–ª—å
```

1. –†–∞–∑—ã–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è
    
    ```c
    *p;
    ```
    
2. –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ 
    
    –ü—Ä–∏–±–∞–≤–∏—Ç—å —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ - –æ—Ç—Å—Ç—É–ø–∏—Ç—å —Å—Ç–æ–ª—å–∫–æ —ç–ª-–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ (–∫ –∞–¥—Ä–µ—Å—É —É–∫–∞–∑–∞—Ç–µ–ª—è –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è —ç—Ç–æ —á–∏—Å–ª–æ * sizeof(type))
    
    ```c
    int *ptr = &arr[0];
        for (int i = 0; i < ARRLEN(arr); ++i) {
            printf("%d\n", *(ptr + i));
        }
    ```
    
    —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω–æ
    
    ```c
    int *ptr = &arr[0];
        for (int i = 0; i < ARRLEN(arr); ++i) {
            printf("%d\n", ptr[i]);
        }
    ```

### –°—Ç—Ä–æ–∫–∏

0-—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ - –º–∞—Å—Å–∏–≤ –±–∞–π—Ç, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–π—Å—è –Ω–∞ `\0`

```c
char[] c = "hello world\n"; // –ª–µ–∂–∏—Ç –Ω–∞ —Å—Ç–µ–∫–µ
c[0]="H"; //–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å, –Ω–æ –¥–ª–∏–Ω—É —Å—Ç—Ä–æ–∫–∏ –º–µ–Ω—è—Ç—å –Ω–µ–ª—å–∑—è

//—Ç–∞–∫—É—é —Å—Ç—Ä–æ–∫—É –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –ø–æ–º–µ–Ω—è—Ç—å, –æ–Ω–∞ –ª–µ–∂–∏—Ç –≤ rodata
char* str = "hello world\n";
```

–î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ `char* str = "hello world\n"`:

```c
int strlen(char* s){
    int i;
    for (i = 0; s[i] != '\0'; ++i);
    return i;
}

int main(void){
    char* str =  "hello world\n";
    printf("%d %s", strlen(str), str);
}
```

## –ö–æ–µ-—á—Ç–æ –ø—Ä–æ –≤–≤–æ–¥ –∏ –≤—ã–≤–æ–¥
### [Printf](https://man7.org/linux/man-pages/man3/printf.3.html)

```c
int printf(const char *restrict format, ...);
```

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç printf: 

1. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä–æ—á–∫—É —Å —Ñ–æ—Ä–º–∞—Ç–æ–º
2. –ß–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É, –ø–µ—á–∞—Ç–∞–µ—Ç –æ–±—ã—á–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –ø–æ–∫–∞ –Ω–µ –¥–æ–π–¥–µ—Ç –¥–æ —Å–∏–º–≤–æ–ª–∞ %
3. –°–º–æ—Ç—Ä–∏—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞

```c
"%d" - int
"%s" - char*
"%x" - int –≤ 16—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å—á–∏—Å–ª–µ–Ω–∏—è, "%o" - –≤ 8—Ä–∏—á–Ω–æ–π
```

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞

```c
h - short
l - long int
```

```c
short s = 7;
printf("%d %hd", strlen(str), s); // integer promotion of s
```

### [Scanf](https://man7.org/linux/man-pages/man3/scanf.3.html)

```c
int scanf(const char *restrict format, ...);
```

- –û—á–µ–Ω—å –≤–∞–∂–µ–Ω —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ —á–∏—Å–ª–∞ ‚Äì –≤ printf –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è
  –¥–æ —Ä–∞–∑–º–µ—Ä–∞ int, –∞ —Ç—É—Ç –º—ã –ø–µ—Ä–µ–¥–∞—ë–º —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –ø–∞–º—è—Ç—å.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª-–≤–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π (–µ—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—è —Å—á–∏—Ç–∞—Ç—å –Ω–µ —É–¥–∞–ª–æ—Å—å, —Ç–æ 0).
- –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π: –µ—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—è –Ω–µ —Å—á–∏—Ç–∞–Ω–æ –∏¬†–¥–æ—Å—Ç–∏–≥–Ω—É—Ç _–∫–æ–Ω–µ—Ü –≤–≤–æ–¥–∞_,
  –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ EOF (—Å¬†–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –æ–±¬†–æ–∫–æ–Ω—á–∞–Ω–∏–∏ –≤–≤–æ–¥–∞ –º–æ–∂–Ω–æ
  –ø—Ä–æ—Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞–∂–∞–≤ Ctrl-D).

**–í–≤–æ–¥ —á–∏—Å–ª–∞**

```c
int main(void) {
    short shint = 7;
    int result = scanf("%hd", &shint);
    if (result == EOF) {
        printf("empty input\n");
        return 1;
    }
    if (result != 1) {
        printf("error\n");
        return 1;
    }
}
```

**–í–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏** - —á–∏—Ç–∞–µ—Ç –¥–æ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–±–µ–ª–∞

```c
int main(void) {
    char buf[100];

    int result = scanf("%s", buf);
    if (result != 1) {
        printf("error\n");
        return 1;
    }
    printf("buf : %s\n", buf);
}
```

–ß—Ç–æ–±—ã –Ω–µ –Ω–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å –∑–∞ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ –±—É—Ñ–µ—Ä–∞:

```c
int main(void) {
    char buf[3] = {0};

    int result = scanf("%2s", buf);
    if (result != 1) {
        printf("error\n");
        return 1;
    }
    printf("buf : %s\n", buf);
}
```

* –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (—á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –≤–≤–æ–¥ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω)

### –°–∏–º–≤–æ–ª—ã –≤–Ω–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ ASCII - Unicode

–í ASCII 127 —Å–∏–º–≤–æ–ª–æ–≤, –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ 1 –±–∞–π—Ç. Unicode - –∫–æ–¥–∏—Ä–æ–≤–∫–∞, –≥–¥–µ –∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä code point.

```python
# python
ord('f')  # 102
chr(1100) # —å
```

–í –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ code points –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–ø–µ—Ä—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–º utf-8. –û–Ω–∞
–∑–∞–ø–∏—Ö–∏–≤–∞–µ—Ç –≤—Å–µ —Å–∏–º–≤–æ–ª—ã –≤ –±–∞–π—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É. –°–∏–º–≤–æ–ª—ã ascii –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ
–∫–æ–¥–∞–º–∏. –í–Ω–µ ascii ‚Äî —Ä–∞—Å–ø–∏–ª–∏–º —á–∏—Å–ª–æ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ –±–∏—Ç, —Å—Ç–∞—Ä—à–∏–º–∏ –±–∏—Ç–∞–º–∏
–±—É–¥–µ–º –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∏—Ö  –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å

```
ùÑû ‚Üê U+1D11E MUSICAL SYMBOL G CLEF
0x1d11e = 0b11101_000100_011110

UTF-8: 0b11110_000 0b10_011101 0b10_000100 0b10_011110
```

```python
In [1]: [bin(b) for b in 'q'.encode('utf-8')]
Out[1]: ['0b01110001']

In [2]: [bin(b) for b in '—è'.encode('utf-8')]
Out[2]: ['0b11010001', '0b10001111']

In [3]: [bin(b) for b in '„ÉÑ'.encode('utf-8')]
Out[3]: ['0b11100011', '0b10000011', '0b10000100']

In [4]: [bin(b) for b in 'ùÑû'.encode('utf-8')]
Out[4]: ['0b11110000', '0b10011101', '0b10000100', '0b10011110']
```

Overlong encoding ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–µ–≥–æ —á–∏—Å–ª–∞ –±–∞–π—Ç, —á–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
`0b110_00000 0b10_100001` ‚Üí —Å–∏–º–≤–æ–ª `chr(0b100001) == '!'`.

[–°—Ç–∞—Ç—å—è –ø—Ä–æ –Æ–Ω–∏–∫–æ–¥](https://tonsky.me/blog/unicode)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã

Declarations and definitions

Translation unit

Extern, static

## –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ç–∏–ø—ã

Arrays and structures

Aggregate initializers

Array dimensions

Pointer arithmetic

Typedef

Alignment

## –î—Ä—É–≥–∏–µ —Ç–µ–º—ã

Hosted vs freestanding

Stdio

Argc/argv

Strings

Restrict

Noreturn etc

VLA

Function pointers
